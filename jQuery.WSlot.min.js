(function(f){f.fn.WSlot=function(x){if(x=="rollTo"){var v=(Array.prototype.slice.call(arguments,1));this.trigger(i,v);return}if(x=="get"){return this.children("div."+j).index()}if(x=="getText"){return this.children("div."+j).text()}var k=f.extend({},f.fn.WSlot.defaults,x);this.off(i).on(i,function(y,z){self=f(this);if(z){t(self,z)}});var m={};m.position="relative";m[h]="rotateY("+k.rotation+"deg)";m[h+"-style"]="preserve-3d";this.css(m).addClass("wslot-container");var w="";if(k.items.length){var n=0;if(k.center=="first"){n=0}else{if(k.center=="last"){n=k.items.length-1}else{if(k.center=="center"){n=parseInt(k.items.length/2)}else{if(f.isNumeric(k.center)&&(k.center>=0)&&(k.center<k.items.length)){n=k.center}else{if(k.center>=k.items.length){n=k.items.length-1}else{n=0}}}}}var l=parseInt(this.height()/2);if(f.isNumeric(k.distance)){l=k.distance}var m="position: absolute;left: 0;width: 100%;height: "+k.item_height+"px;top: 50%;margin-top: -"+Math.round(k.item_height/2)+"px;";for(var s=0;s<k.items.length;s++){var r="";if(Math.abs(s-n)>k.displayed_length){r="display:none;"}var q=k.angle*(n-s);var u=0;var o=k.angle*k.displayed_length;if(Math.abs(q)<=o){u=1-(Math.abs(q)/(o*2))}var p="transform:rotateX("+q+"deg) translate3d(0,0,"+l+"px);-webkit-transform:rotateX("+q+"deg) translate3d(0,0,"+l+"px);";w+='<div class="wslot-item '+((s==n)?j:"")+'" style="'+p+r+m+"opacity:"+u+';">'+k.items[s]+"</div>"}return this.html(w).data("cur-angle",(n*k.angle)).off(b).on(b,function(z){var y=f(this);y.addClass("w-roll-touched").data("initialtouch",e(z).y);return false}).off(c).on(c,function(C){var A=f(this);if(A.is(".w-roll-touched")){var y=A.data("initialtouch")-e(C).y;var B=parseInt(A.data("cur-angle"))+parseInt(y/2);var D=(k.items.length-1)*k.angle;if(B<0){var z=0-B;B=-(25*z/(z+25))}else{if(B>D){var z=B-D;B=D+(25*z/(z+25))}}A.children("div").each(function(){var I=f(this);var G={};var H=B-(I.index()*k.angle);G.display="";if(Math.abs(H)>k.displayed_length*k.angle){G.display="none"}var F=0;var E=k.angle*k.displayed_length;if(Math.abs(H)<=E){F=1-(Math.abs(H)/(E*2))}G[h]="rotateX("+H+"deg) translateZ("+l+"px)";G.opacity=F;I.css(G)})}return false}).off(d).on(d,function(D){var A=f(this);if(A.is(".w-roll-touched")){var y=A.data("initialtouch")-e(D).y;var C=parseInt(A.data("cur-angle"))+parseInt(y/2);var E=(k.items.length-1)*k.angle;var B=Math.round(C/k.angle);if(C<0){var z=0-C;C=-(25*z/(z+25));B=0}else{if(C>E){var z=C-E;C=E+(25*z/(z+25));B=(k.items.length-1)}}A.data("cur-angle",C);t(A,B)}A.removeClass("w-roll-touched");return false})}else{return this}function t(B,A){if(A<0){A=0}else{if(A>=k.items.length){A=k.items.length-1}}var y=parseInt(B.data("cur-angle"));var z=A*k.angle;var C=z-y;g(10,1,function(F,E,G){var D=a(E,y,C,F);G.children("div").each(function(){var L=f(this);var J={};var K=D-(L.index()*k.angle);J.display="";if(Math.abs(K)>k.displayed_length*k.angle){J.display="none"}var I=0;var H=k.angle*k.displayed_length;if(Math.abs(K)<=H){I=1-(Math.abs(K)/(H*2))}J[h]="rotateX("+K+"deg) translateZ("+l+"px)";J.opacity=I;L.css(J)})},function(D){D.children("div").each(function(){var I=f(this).removeClass(j);var G={};var H=z-(I.index()*k.angle);G.display="";if(Math.abs(H)>k.displayed_length*k.angle){G.display="none"}var F=0;var E=k.angle*k.displayed_length;if(Math.abs(H)<=E){F=1-(Math.abs(H)/(E*2))}G[h]="rotateX("+H+"deg) translateZ("+l+"px)";G.opacity=F;I.css(G);if(H==0){I.addClass(j)}});D.data("cur-angle",z);D.trigger("WSlot.change",[A])},B)}};f.fn.WSlot.defaults={items:[],center:"first",distance:"auto",displayed_length:2,angle:30,rotation:0,item_height:20,};var h="transform";["webkit","Moz","O","ms"].every(function(k){var l=k+"Transform";if(typeof document.body.style[l]!=="undefined"){h=l}});var b="touchstart mousedown";var c="touchmove mousemove";var d="touchend mouseup mouseleave";var i="WSlot.rollTo";var j="wslot-item-selected";function g(m,l,k,n,o){if(l<=m){if(typeof k=="function"){k(m,l,o)}l=l+1;window.requestAnimationFrame(function(){g(m,l,k,n,o)})}else{if(typeof n=="function"){n(o)}}}function e(k){if(k.originalEvent){if(k.originalEvent.changedTouches&&(k.originalEvent.changedTouches.length>=1)){return{x:k.originalEvent.changedTouches[0].pageX,y:k.originalEvent.changedTouches[0].pageY}}return{x:k.originalEvent.clientX,y:k.originalEvent.clientY}}else{if(k.changedTouches&&(k.changedTouches.length>=1)){return{x:k.changedTouches[0].pageX,y:k.changedTouches[0].pageY}}return{x:k.clientX,y:k.clientY}}}function a(l,k,n,m){return -n*(l/=m)*(l-2)+k}})(jQuery);